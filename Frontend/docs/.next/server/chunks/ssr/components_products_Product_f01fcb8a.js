module.exports=[9033,a=>{"use strict";a.s(["default",()=>t],9033);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(71987),f=a.i(65763),g=a.i(51664),h={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=c.default.createContext&&c.default.createContext(h),j=["attr","size","title"];function k(){return(k=Object.assign.bind()).apply(this,arguments)}function l(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function m(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?l(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):l(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function n(a){return b=>c.default.createElement(o,k({attr:m({},a.attr)},b),function a(b){return b&&b.map((b,d)=>c.default.createElement(b.tag,m({key:d},b.attr),a(b.child)))}(a.child))}function o(a){var b=b=>{var d,{attr:e,size:f,title:g}=a,h=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,j),i=f||b.size||"1em";return b.className&&(d=b.className),a.className&&(d=(d?d+" ":"")+a.className),c.default.createElement("svg",k({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},b.attr,e,h,{className:d,style:m(m({color:a.color||b.color},b.style),a.style),height:i,width:i,xmlns:"http://www.w3.org/2000/svg"}),g&&c.default.createElement("title",null,g),a.children)};return void 0!==i?c.default.createElement(i.Consumer,null,a=>b(a)):b(h)}function p(a){return n({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},child:[]},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},child:[]}]})(a)}function q(a){return n({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(a)}var r=a.i(98891);let s=(a,b)=>{let c=new Set(b.map(a=>a.documentId));return[...b,...a.filter(a=>!c.has(a.documentId))]};function t(){let a=(0,d.useRouter)(),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[t,u]=(0,c.useState)("all"),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)({open:!1,prodId:null}),[z,A]=(0,c.useState)({}),[B,C]=(0,c.useState)(()=>!1),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)({}),[H,I]=(0,c.useState)("");(0,c.useEffect)(()=>{let a=localStorage.getItem("user");if(a)try{let b=JSON.parse(a);i(b)}catch(a){console.error("Failed to parse user data:",a)}},[]),(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,r.fetchProductsAPI)(),b=[];if(a.products&&void 0!==a.products.draftProducts&&void 0!==a.products.publishedProducts){let c=(0,r.formatProductData)(a.products.draftProducts||[]),d=(0,r.formatProductData)(a.products.publishedProducts||[]);b=s(c,d)}else if(void 0!==a.draftProducts&&void 0!==a.publishedProducts){let c=(0,r.formatProductData)(a.draftProducts||[]),d=(0,r.formatProductData)(a.publishedProducts||[]);b=s(c,d)}else a.products&&Array.isArray(a.products)?b=(0,r.formatProductData)(a.products):a.products&&(b=(0,r.formatProductData)(a.products));b=b.sort((a,b)=>{if(a.createdAt&&b.createdAt)return new Date(b.createdAt)-new Date(a.createdAt);if(a.updatedAt&&b.updatedAt)return new Date(b.updatedAt)-new Date(a.updatedAt);let c=Number(a.documentId),d=Number(b.documentId);return isNaN(c)||isNaN(d)?(b.documentId||"").toString().localeCompare((a.documentId||"").toString()):d-c}),k(b)}catch(a){I("Failed to load products")}})()},[]);let J=j.filter(a=>{let b=a.name?.toLowerCase().includes(l.toLowerCase()),c=!0;return"draft"===t?c=!a.publishedAt:"published"===t&&(c=!!a.publishedAt),b&&c}),[K,L]=(0,c.useState)(1),M=Math.ceil(J.length/6),N=J.slice((K-1)*6,6*K),O=a=>{a>=1&&a<=M&&L(a)},P=async a=>{try{let b=await (0,r.deleteProductAPI)(a);"success"===b.status?(k(b=>b.filter(b=>b.documentId!==a)),(0,g.showToast)("Product deleted successfully!","success")):(0,g.showToast)("Delete failed: "+b.message,"error")}catch(a){(0,g.showToast)("Error deleting product","error")}finally{y({open:!1,prodId:null})}};return(0,c.useEffect)(()=>{let a=a=>{var b;a.detail&&a.detail.product&&(b=a.detail.product,k(a=>{let c=a.filter(a=>a.documentId!==b.documentId);return[b,...c].sort((a,b)=>{if(a.createdAt&&b.createdAt)return new Date(b.createdAt)-new Date(a.createdAt);if(a.updatedAt&&b.updatedAt)return new Date(b.updatedAt)-new Date(a.updatedAt);let c=Number(a.documentId),d=Number(b.documentId);return isNaN(c)||isNaN(d)?(b.documentId||"").toString().localeCompare((a.documentId||"").toString()):d-c})}))};return window.addEventListener("product-updated",a),()=>window.removeEventListener("product-updated",a)},[]),(0,c.useEffect)(()=>{let a=a=>{v&&!a.target.closest(".filter-dropdown-container")&&w(!1)};return document.addEventListener("click",a),()=>document.removeEventListener("click",a)},[v]),(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,b.jsx)(f.default,{profile:h,onLogout:()=>{localStorage.removeItem("token"),a.push("/signin")},onCollapseChange:C}),(0,b.jsx)("div",{className:"flex-1 transition-all duration-300",style:{marginLeft:B?"80px":"256px"},children:(0,b.jsxs)("div",{className:"max-w-8xl mx-5 px-6 py-8",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-20 bg-gray-50 pb-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2 pt-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Product Management"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage your AgChem product catalog"})]}),j.length>0&&(0,b.jsx)("button",{className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded transition-colors text-white !text-white flex items-center justify-center cursor-pointer font-semibold text-sm h-12",style:{color:"#fff"},onClick:()=>a.push("/add-product"),children:"+ Add New Product"})]}),(0,b.jsxs)("div",{className:"bg-white p-4 rounded-lg flex gap-4 items-center justify-between mb-2",children:[(0,b.jsx)("input",{placeholder:"Search products...",className:"border p-2 rounded w-64",value:l,onChange:a=>m(a.target.value)}),(0,b.jsxs)("div",{className:"relative filter-dropdown-container",children:[(0,b.jsxs)("button",{onClick:()=>w(!v),className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded flex items-center gap-2 transition-colors text-white !text-white font-semibold text-sm h-10",style:{color:"#fff"},children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter"]}),v&&(0,b.jsxs)("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-300 rounded shadow-lg z-10 w-56",children:[(0,b.jsx)("div",{className:"p-3 border-b",children:(0,b.jsx)("input",{type:"text",placeholder:"Search filters...",className:"w-full border p-2 rounded text-sm",value:n,onChange:a=>o(a.target.value)})}),(0,b.jsxs)("div",{className:"p-3",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Status"}),(0,b.jsx)("div",{className:"space-y-1",children:["All Products","Draft","Published"].filter(a=>a.toLowerCase().includes(n.toLowerCase())).map(a=>{let c="All Products"===a?"all":a.toLowerCase();return(0,b.jsx)("button",{onClick:()=>{u(c),w(!1)},className:`block w-full text-left px-3 py-2 rounded text-sm ${t===c?"bg-green-100 text-green-700 font-semibold":"hover:bg-gray-100"}`,children:a},a)})})]})]})]})]}),(0,b.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Showing ",J.length," of ",j.length," products"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{style:{minHeight:"200px",maxHeight:"calc(100vh - 260px)",overflowY:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar",children:0===j.length?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center w-full",style:{minHeight:"calc(100vh - 260px)"},children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,b.jsx)("img",{src:"/empty-bg.png",alt:"Empty products",style:{maxWidth:"600px",width:"100%",height:"auto",marginBottom:"20px"}}),(0,b.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-3",children:"Nothing here yet..."}),(0,b.jsx)("p",{className:"text-gray-600 text-lg mb-8",children:"Looks like products are on vacation."}),(0,b.jsx)("button",{onClick:()=>a.push("/add-product"),className:"border border-green-500 bg-transparent text-black px-5 py-3 rounded font-semibold text-lg transition-colors hover:bg-green-700 hover:text-white",children:"+ Add Product"})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-stretch",children:[...N].map(c=>(0,b.jsxs)("div",{className:"bg-white shadow p-5 rounded-lg flex flex-col justify-between items-stretch min-h-[420px] h-full w-full max-w-[370px] mx-auto cursor-pointer",onClick:()=>a.push(`/products/view/${c.documentId}`),children:[(0,b.jsxs)("div",{className:"relative h-44 w-full bg-gray-100 rounded-lg flex items-center justify-center",children:[(0,b.jsx)(e.default,{src:c.images[F[c.documentId]||0],alt:c.name,width:300,height:176,className:"h-44 w-full object-contain rounded-lg",unoptimized:!0}),c.images.length>1&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-50 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",onClick:()=>{G(a=>{let b=a[c.documentId]||0;return{...a,[c.documentId]:0===b?0:b-1}})},disabled:0===(F[c.documentId]||0),children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,b.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white p-2 rounded-full shadow-md hover:bg-gray-50 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",onClick:()=>{G(a=>{let b=a[c.documentId]||0,d=b===c.images.length-1?b:b+1;return{...a,[c.documentId]:d}})},disabled:(F[c.documentId]||0)===c.images.length-1,children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),c.images.length>1&&(0,b.jsx)("div",{className:"flex justify-center mt-2 space-x-2",children:c.images.map((a,d)=>(0,b.jsx)("span",{className:`w-3 h-3 rounded-full ${(F[c.documentId]||0)===d?"bg-green-600":"bg-gray-300"}`},d))}),(0,b.jsx)("div",{className:"font-bold text-lg mt-2",children:c.name.length>40?c.name.slice(0,40)+"...":c.name}),(0,b.jsx)("div",{className:"text-gray-700 text-sm mt-1",children:(()=>{let a=c.description||"";if(!(a.length>150))return a;let d=a.substring(0,150)+"...";return(0,b.jsxs)(b.Fragment,{children:[z[c.documentId]?a:d,(0,b.jsx)("button",{className:"text-green-600 font-semibold ml-2",onClick:()=>{var a;return a=c.documentId,void A(b=>({...b,[a]:!b[a]}))},children:z[c.documentId]?"Read Less":"Read More"})]})})()}),(0,b.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,b.jsx)("button",{className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded transition-colors text-white !text-white flex items-center justify-center cursor-pointer",style:{color:"#fff"},title:"Edit",onClick:()=>a.push(`/products/edit/${c.documentId}`),children:(0,b.jsx)(p,{size:18})}),(0,b.jsx)("button",{className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded transition-colors text-white !text-white flex items-center justify-center cursor-pointer",style:{color:"#fff"},title:"Delete",onClick:()=>y({open:!0,prodId:c.documentId}),children:(0,b.jsx)(q,{size:18})})]})]},c.documentId))})}),M>1&&(0,b.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-6",children:[(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-200",onClick:()=>O(K-1),disabled:1===K,children:"Prev"}),Array.from({length:M},(a,c)=>(0,b.jsx)("button",{className:`px-3 py-1 rounded ${K===c+1?"bg-green-600 text-white":"bg-gray-200 hover:bg-gray-300"}`,onClick:()=>O(c+1),children:c+1},c)),(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-200",onClick:()=>O(K+1),disabled:K===M,children:"Next"})]})]})]})}),x.open&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full border border-gray-200 relative",children:[(0,b.jsx)("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold",onClick:()=>y({open:!1,prodId:null}),"aria-label":"Close",children:"×"}),(0,b.jsx)("h3",{className:"text-lg font-bold mb-3 text-gray-900",children:"Delete Confirmation"}),(0,b.jsxs)("p",{className:"mb-5 text-base text-gray-800",children:["Are you sure that you want to delete the product:",(0,b.jsx)("span",{className:"font-bold text-red-600 ml-1",children:j.find(a=>a.documentId===x.prodId)?.name||""}),"?"]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsxs)("button",{className:"flex items-center gap-2 px-5 py-2 rounded bg-green-600 text-white hover:bg-green-700 font-semibold text-base",onClick:()=>P(x.prodId),children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Yes"]}),(0,b.jsxs)("button",{className:"flex items-center gap-2 px-5 py-2 rounded bg-green-600 text-white hover:bg-green-700 font-semibold text-base",onClick:()=>y({open:!1,prodId:null}),children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),"No"]})]})]})}),D.length>0&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white p-4 rounded-lg max-w-xl w-full relative",children:[(0,b.jsx)("button",{onClick:()=>E([]),className:"absolute top-2 right-2 text-gray-700 font-bold",children:"✕"}),(0,b.jsx)("div",{className:"flex items-center justify-center gap-2",children:D.map((a,c)=>(0,b.jsx)(e.default,{src:a,width:400,height:256,className:"h-64 w-auto rounded-lg",alt:"Product preview",unoptimized:!0},c))})]})})]})}}];

//# sourceMappingURL=components_products_Product_f01fcb8a.js.map