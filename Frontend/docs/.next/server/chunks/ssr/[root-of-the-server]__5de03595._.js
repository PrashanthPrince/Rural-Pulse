module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},51664,a=>{"use strict";a.s(["showToast",()=>c]),a.i(87924);var b=a.i(20094);function c(a,d="info"){b.toast[d](a,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})}},42627,a=>{"use strict";a.s(["default",()=>f]);var b=a.i(87924),c=a.i(72131),d=a.i(71987),e=a.i(61367);function f({initialData:a={},onSubmit:f,onCancel:g,isLoading:h=!1,mode:i="add"}){let[j,k]=(0,c.useState)({name:a.name||"",description:a.description||""}),[l,m]=(0,c.useState)({}),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(0),[v,w]=(0,c.useState)(a.image||[]),[x,y]=(0,c.useState)([]),z=a=>{let{name:b,value:c}=a.target;"description"===b?c.length<=500&&k(a=>({...a,[b]:c})):k(a=>({...a,[b]:c}))},A=(()=>{if("edit"===i&&v.length>0){let a=[...v];return x.forEach((b,c)=>{c<r.length&&(a[b]={...r[c],isNew:!0})}),r.length>x.length&&a.push(...r.slice(x.length).map(a=>({...a,isNew:!0}))),a}return r})();return(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-10 w-full max-w-4xl mx-auto font-sans",children:["add"===i&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"Add New Product"}),(0,b.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:"Create a new product for your catalog"})]}),"edit"===i&&(0,b.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Product"}),(0,b.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Update your product catalog"})]}),(0,b.jsx)("button",{type:"button",onClick:g,className:"text-gray-500 hover:text-gray-700 text-xl",children:"âœ•"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault();let b={},c=String(j.name??""),d=String(j.description??""),e=0;e="add"===i?n.length:(v?.length||0)+(n?.length||0),c.trim()||(b.name="Name is required"),d.trim()||(b.description="Description is required"),0===e&&(b.images="At least one image is required"),m(b),Object.keys(b).length>0||f({formData:{...j,name:c,description:d},imageFiles:n,existingImages:v,selectedSlots:x})},children:[(0,b.jsx)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-xs font-medium text-black mb-1",children:["Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",name:"name",value:j.name,onChange:z,className:`w-full px-3 py-1.5 text-sm border ${l.name?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-green-500"} rounded-md focus:ring-2 focus:border-transparent`,placeholder:"Enter product name",autoComplete:"off"}),l.name&&(0,b.jsx)("div",{className:"text-xs text-red-500 mt-1",children:l.name})]})}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-xs font-medium text-black mb-1",children:["Description ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("textarea",{name:"description",value:j.description,onChange:z,className:`w-full px-3 py-1.5 text-sm border ${l.description?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-green-500"} rounded-md focus:ring-2 focus:border-transparent resize-none`,placeholder:"Enter description",rows:"4",maxLength:500,autoComplete:"off"}),(0,b.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[l.description&&(0,b.jsx)("div",{className:"text-xs text-red-500",children:l.description}),(0,b.jsxs)("div",{className:"text-right text-xs text-gray-500 ml-auto",children:[j.description.length," / ",500," characters"]})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-xs font-medium text-black mb-1",children:["Images ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})," ",0===A.length?"":`[${t+1}/${A.length}]`]}),l.images&&(0,b.jsx)("div",{className:"text-xs text-red-500 mb-1",children:l.images}),p&&(0,b.jsx)("div",{className:"text-xs text-red-500 mb-1",children:p}),A.length>0?(0,b.jsxs)("div",{className:"relative bg-gray-100 rounded-lg p-3 mb-3 h-[160px]",children:[A.length>1&&(0,b.jsx)("button",{type:"button",onClick:()=>{u(a=>(a-1+A.length)%A.length)},className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-50 z-10 flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,b.jsx)("div",{className:"h-24 flex items-center justify-center",children:(0,b.jsx)(d.default,{src:A[t]?.isNew||!A[t]?.url?.startsWith("/")?A[t]?.url||"":`${e.STRAPI_URL}${A[t].url}`,alt:"Product preview",width:300,height:96,className:"max-h-24 max-w-full object-contain",unoptimized:!0})}),(0,b.jsxs)("div",{className:"absolute bottom-3 left-0 right-0 flex items-center justify-center gap-2 px-3",children:[(0,b.jsx)("div",{className:"bg-white px-2 py-0.5 rounded-md shadow-sm max-w-xs truncate",children:(0,b.jsx)("span",{className:"text-xs text-gray-700",children:A[t]?.name||`Image ${t+1}`})}),(0,b.jsxs)("div",{className:"flex items-center gap-0.5 bg-white rounded-md shadow-sm p-0.5",children:[(0,b.jsx)("button",{type:"button",onClick:()=>(a=>{"edit"===i?(w(v.filter((b,c)=>c!==a)),y(b=>b.filter(b=>b!==a).map(b=>b>a?b-1:b))):(o(b=>b.filter((b,c)=>c!==a)),s(b=>b.filter((b,c)=>c!==a))),t>=A.length-1&&u(0)})(t),className:"hover:bg-gray-100 p-1 rounded cursor-pointer",title:"Delete image",children:(0,b.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,b.jsxs)("label",{className:"cursor-pointer hover:bg-gray-100 p-1 rounded",title:"Replace current image",children:[(0,b.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{q("");let b=a.target.files?.[0];if(b&&!["image/png","image/jpeg","image/jpg"].includes(b.type)){q("Only PNG & JPEG images are allowed."),a.target.value="";return}if(b)if("edit"===i)x.includes(t)||y(a=>[...a,t]),o(a=>[...a,b]),s(a=>[...a,{url:URL.createObjectURL(b),name:b.name}]);else{let a=[...n];a[t]=b,o(a);let c=[...r];c[t]={url:URL.createObjectURL(b),name:b.name},s(c)}a.target.value=""},className:"hidden"})]}),(0,b.jsxs)("label",{className:"cursor-pointer hover:bg-gray-100 p-1 rounded",title:"Add more images",children:[(0,b.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,b.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{q("");let b=Array.from(a.target.files||[]),c=["image/png","image/jpeg","image/jpg"];if(b.find(a=>!c.includes(a.type))){q("Only PNG & JPEG images are allowed."),a.target.value="";return}o([...n,...b]),s([...r,...b.map(a=>({url:URL.createObjectURL(a),name:a.name}))])},className:"hidden"})]})]})]}),A.length>1&&(0,b.jsx)("button",{type:"button",onClick:()=>{u(a=>(a+1)%A.length)},className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-50 z-10 flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}):(0,b.jsxs)("label",{className:"cursor-pointer block mb-3",children:[(0,b.jsx)("div",{className:"relative bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg hover:bg-gray-100 hover:border-green-400 transition-all h-[160px]",children:(0,b.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center mb-2",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,b.jsx)("p",{className:"text-gray-600 text-xs",children:"Click to add Images"})]})}),(0,b.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{q("");let b=Array.from(a.target.files||[]),c=["image/png","image/jpeg","image/jpg"];if(b.find(a=>!c.includes(a.type))){q("Only PNG & JPEG images are allowed."),a.target.value="";return}o(b),s(b.map(a=>({url:URL.createObjectURL(a),name:a.name})))},className:"hidden"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,b.jsx)("button",{type:"button",onClick:g,className:"px-5 py-1.5 text-sm bg-green-600 hover:bg-green-700 rounded-md transition-colors text-white !text-white",style:{color:"#fff"},disabled:h,children:"Cancel"}),(0,b.jsx)("button",{type:"button",onClick:()=>f({action:"draft",formData:j,imageFiles:n,existingImages:v,selectedSlots:x}),className:"bg-green-600 text-white px-4 py-2 rounded",children:"Save"}),(0,b.jsx)("button",{type:"button",onClick:()=>f({action:"published",formData:j,imageFiles:n,existingImages:v,selectedSlots:x}),className:"bg-green-600 text-white px-4 py-2 rounded",children:"Publish"})]})]})]})}},18705,a=>{"use strict";a.s(["default",()=>j],18705);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(42627),f=a.i(65763),g=a.i(98891),h=a.i(51664);function i({product:a,onClose:i}){let j=(0,d.useRouter)(),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(()=>!1);(0,c.useEffect)(()=>{let a=localStorage.getItem("user");if(a)try{let b=JSON.parse(a);n(b)}catch(a){}},[]);let q=async({formData:b,imageFiles:c,existingImages:d,selectedSlots:e=[],action:f})=>{l(!0);try{let i=new FormData;if(i.append("name",b.name),i.append("description",b.description),d.filter((a,b)=>!e.includes(b)).forEach(a=>{i.append("existingImageIds[]",a?.id||"")}),e.length>0&&e.forEach(a=>{i.append("selectedSlots[]",a)}),c.forEach(a=>{i.append("files",a)}),i.append("status",f),!(await (0,g.updateProductAPI)(a.documentId,i)).success)throw Error("Update failed");(0,h.showToast)("Product saved successfully!","success"),setTimeout(()=>j.push("/products"),600)}catch(a){(0,h.showToast)(a.message||"Failed to update product","error")}finally{l(!1)}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[(0,b.jsx)(f.default,{profile:m,onLogout:()=>{localStorage.removeItem("token"),j.push("/products")},onCollapseChange:p}),(0,b.jsx)("div",{className:"flex-1 transition-all duration-300",style:{marginLeft:o?"80px":"256px"},children:(0,b.jsx)("div",{className:"max-w-8xl mx-5 px-6 py-8",children:(0,b.jsx)("div",{className:"flex justify-center items-start",children:(0,b.jsx)("div",{className:"w-full max-w-full mx-auto",children:(0,b.jsx)(e.default,{mode:"edit",initialData:{name:a.name,description:a.description,image:a.image||[]},onSubmit:q,onCancel:()=>{i&&i()},isLoading:k})})})})})]})}function j(){let a=(0,d.useRouter)(),{id:e}=(0,d.useParams)(),[f,h]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{async function b(){k(!0);try{let b=await (0,g.fetchProductsAPI)(),c=[];if(b.products&&void 0!==b.products.draftProducts&&void 0!==b.products.publishedProducts){let a=(0,g.formatProductData)(b.products.draftProducts||[]),d=(0,g.formatProductData)(b.products.publishedProducts||[]),e=new Set(a.map(a=>a.documentId)),f=d.filter(a=>!e.has(a.documentId));c=[...a,...f]}else if(void 0!==b.draftProducts&&void 0!==b.publishedProducts){let a=(0,g.formatProductData)(b.draftProducts||[]),d=(0,g.formatProductData)(b.publishedProducts||[]),e=new Set(a.map(a=>a.documentId)),f=d.filter(a=>!e.has(a.documentId));c=[...a,...f]}else b.products&&Array.isArray(b.products)?c=(0,g.formatProductData)(b.products):b.products&&(c=(0,g.formatProductData)(b.products));let d=c.find(a=>a.documentId===e);d?h(d):(alert("Product not found"),a.push("/products"))}catch(b){alert("Failed to load product"),a.push("/products")}finally{k(!1)}}e&&b()},[e,a]),j)?(0,b.jsx)("div",{className:"p-10 text-center",children:"Loading..."}):f?(0,b.jsx)(i,{product:f,onClose:()=>a.push("/products")}):null}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5de03595._.js.map